<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Addition with Regrouping — Practice</title>
  <meta name="description" content="Clean interactive practice for addition with regrouping — made for a tech-loving homeschooler." />

  <style>
    :root{
      --bg:#0b1020;
      --panel:#0f1724;
      --muted:#9aa4b2;
      --accent:#22d3ee;
      --accent-2:#7c3aed;
      --good:#16a34a;
      --bad:#ef4444;
      --card:#071025;
      --glass: rgba(255,255,255,0.03);
      font-synthesis: none;
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg),#031025 120%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:24px;
      box-sizing:border-box;
    }

    .wrap{
      max-width:1000px;
      margin:0 auto;
    }

    header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:18px;
    }
    .logo{
      width:64px;height:64px;border-radius:12px;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;
      font-weight:700;color:#021022;font-size:20px;
      box-shadow:0 6px 20px rgba(34,211,238,0.12);
    }
    h1{margin:0;font-size:20px;}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .layout{
      display:grid;
      grid-template-columns: 340px 1fr;
      gap:20px;
      margin-top:18px;
    }

    .card{
      background:linear-gradient(180deg,var(--panel),#07142a);
      border-radius:12px;padding:16px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }

    /* Controls */
    .controls label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    .controls .row{display:flex;gap:8px;align-items:center;margin-bottom:12px}
    select,input[type="number"]{
      background:var(--glass);border:1px solid rgba(255,255,255,0.04);
      color:inherit;padding:8px;border-radius:8px;font-size:14px;width:100%;
    }
    .switch{
      display:flex;gap:8px;align-items:center;
    }
    .btn{
      display:inline-flex;align-items:center;gap:8px;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#021022;font-weight:700;padding:10px 14px;border-radius:10px;border:none;
      cursor:pointer; box-shadow:0 8px 18px rgba(7,20,40,0.4);
    }
    .btn.ghost{
      background:transparent;border:1px solid rgba(255,255,255,0.05);color:var(--accent);
    }
    .tiny{font-size:13px;padding:6px 9px;border-radius:8px}

    /* Problem area */
    .stage{
      display:flex;flex-direction:column;gap:12px;align-items:stretch;
    }

    .problem-card{
      padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);
      display:flex;gap:16px;align-items:flex-start;
    }
    .vertical-add{
      background:linear-gradient(180deg,#041426 80%,transparent);
      padding:18px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);
      min-width:260px;
      position:relative;
    }

    /* vertical layout */
    .digits{
      display:flex;flex-direction:column;align-items:flex-end;gap:4px;font-family: "Courier New", ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;
      font-size:30px;color:#e6eef6;
    }
    .carry-row{height:26px;color:var(--accent);font-size:18px}
    .separator{height:2px;background:linear-gradient(90deg,var(--accent),transparent);margin:10px 0;border-radius:2px}
    .sum-row{display:flex;gap:6px;align-items:center}
    .digit-cell{min-width:34px;text-align:center}
    .digit-input{
      width:34px;padding:6px;border-radius:6px;background:transparent;border:1px dashed rgba(255,255,255,0.05);
      color:inherit;font-size:20px;text-align:center;
    }
    .hint{font-size:13px;color:var(--muted);margin-top:8px}

    /* Stats */
    .stats{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .stat{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;font-size:13px;min-width:88px;text-align:center}
    .progress{height:10px;background:rgba(255,255,255,0.03);border-radius:6px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}

    /* Explanation / base-ten */
    .explain{
      margin-top:8px;background:rgba(255,255,255,0.01);padding:12px;border-radius:8px;font-size:14px;color:var(--muted)
    }
    .blocks{
      display:flex;gap:8px;align-items:flex-end;margin-top:10px;
    }
    .column{
      min-width:60px;height:120px;background:rgba(255,255,255,0.01);padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);
      display:flex;flex-direction:column;align-items:center;justify-content:flex-end;
      gap:6px;
    }
    .block{
      width:28px;height:16px;background:linear-gradient(90deg,#ffd27c,#ffb86b);border-radius:4px;border:1px solid rgba(0,0,0,0.12);
    }
    .block.ten{width:56px;height:16px;background:linear-gradient(90deg,#8be3ff,#22d3ee);}

    /* feedback */
    .correct{border:1px solid rgba(22,163,74,0.18);box-shadow:0 6px 22px rgba(22,163,74,0.06)}
    .wrong{border:1px solid rgba(239,68,68,0.14);box-shadow:0 6px 22px rgba(239,68,68,0.04)}

    /* footer help */
    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

    /* responsive */
    @media (max-width:860px){
      .layout{grid-template-columns:1fr; }
      .vertical-add{min-width:100%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo" aria-hidden="true">ADD</div>
      <div>
        <h1>Addition with Regrouping — Practice</h1>
        <p class="lead">A clean, interactive page for learning addition with regrouping — made for a tech-loving homeschool student. Choose settings and try problems, see step-by-step regrouping, or visualize with base-ten blocks.</p>
      </div>
    </header>

    <div class="layout">
      <aside class="card controls" aria-labelledby="controls-heading">
        <h3 id="controls-heading" style="margin-top:0">Settings</h3>

        <div class="row">
          <label for="digits">Digits per addend</label>
          <select id="digits" title="Select number of digits">
            <option value="2">2 digits (e.g., 34 + 17)</option>
            <option value="3" selected>3 digits (e.g., 248 + 167)</option>
            <option value="1">1 digit (practice)</option>
          </select>
        </div>

        <div class="row">
          <label for="forceRegroup">Force regrouping?</label>
          <select id="forceRegroup" title="Require at least one regroup in the problem">
            <option value="either">Either</option>
            <option value="yes">Yes — at least one regroup</option>
            <option value="no">No regroup</option>
          </select>
        </div>

        <div class="row">
          <label for="mode">Mode</label>
          <select id="mode">
            <option value="practice" selected>Practice (step help)</option>
            <option value="challenge">Challenge (timer & streak)</option>
          </select>
        </div>

        <div class="row">
          <label for="problems">Problems per session</label>
          <input id="problems" type="number" min="1" max="50" value="10" />
        </div>

        <div class="row" style="margin-top:4px">
          <button id="newBtn" class="btn tiny" title="New problem">New problem</button>
          <button id="checkBtn" class="btn ghost tiny" title="Check answer">Check</button>
          <button id="explainBtn" class="btn ghost tiny" title="Show step-by-step">Explain</button>
        </div>

        <div style="margin-top:12px">
          <div class="stats">
            <div class="stat">Asked: <strong id="asked">0</strong></div>
            <div class="stat">Correct: <strong id="correct">0</strong></div>
            <div class="stat">Streak: <strong id="streak">0</strong></div>
          </div>

          <div style="margin-top:10px">
            <div class="progress" aria-hidden="true" style="margin-bottom:6px"><i id="progBar"></i></div>
            <div class="hint">Tip: press Enter to submit, use arrow keys to move between digit boxes.</div>
          </div>
        </div>
      </aside>

      <main class="card stage" aria-live="polite">
        <div class="problem-card" id="problemCard">
          <div class="vertical-add" id="verticalAdd" role="group" aria-label="Addition problem">
            <!-- carries -->
            <div class="digits carry-row" id="carryRow" aria-hidden="true"></div>

            <!-- addends -->
            <div class="digits" id="addendRows" aria-hidden="true">
              <!-- added by JS -->
            </div>

            <div class="separator" aria-hidden="true"></div>

            <!-- sum row -->
            <div class="sum-row" id="sumRow" role="group" aria-label="Your answer">
              <!-- digit inputs added by JS -->
            </div>

            <div class="hint" id="problemHint">Generate a new problem to begin.</div>
          </div>

          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-size:12px;color:var(--muted)">Current mode</div>
                <div style="font-weight:700">Practice</div>
              </div>
              <div>
                <button id="showBlocksBtn" class="btn tiny" title="Show base-ten visualization">Show base-ten</button>
              </div>
            </div>

            <div id="explain" class="explain" hidden>
              <div id="explainText">Explanation will appear here.</div>

              <div id="blocksArea" style="margin-top:10px" hidden>
                <div style="font-size:13px;color:var(--muted)">Columns (right = ones)</div>
                <div class="blocks" id="blocksColumns">
                  <!-- base-ten columns inserted by JS -->
                </div>
              </div>
            </div>

            <div id="gameInfo" style="margin-top:12px;color:var(--muted);font-size:13px">
              <div id="sessionInfo"></div>
            </div>
          </div>
        </div>

        <footer>
          If you want, I can adjust difficulty, add more visuals, or make printable worksheets. Tell me what to change.
        </footer>
      </main>
    </div>
  </div>

  <script>
    // Basic interactive addition page
    // Designed to be self-contained and friendly for a tech-interested kid.
    (function(){
      // DOM refs
      const digitsSelect = document.getElementById('digits');
      const forceRegroup = document.getElementById('forceRegroup');
      const modeSelect = document.getElementById('mode');
      const problemsInput = document.getElementById('problems');
      const newBtn = document.getElementById('newBtn');
      const checkBtn = document.getElementById('checkBtn');
      const explainBtn = document.getElementById('explainBtn');
      const showBlocksBtn = document.getElementById('showBlocksBtn');

      const carryRow = document.getElementById('carryRow');
      const addendRows = document.getElementById('addendRows');
      const sumRow = document.getElementById('sumRow');
      const problemHint = document.getElementById('problemHint');
      const explainBox = document.getElementById('explain');
      const explainText = document.getElementById('explainText');
      const blocksArea = document.getElementById('blocksArea');
      const blocksColumns = document.getElementById('blocksColumns');

      // stats
      const askedEl = document.getElementById('asked');
      const correctEl = document.getElementById('correct');
      const streakEl = document.getElementById('streak');
      const progBar = document.getElementById('progBar');
      const sessionInfo = document.getElementById('sessionInfo');

      let state = {
        a: null,
        b: null,
        digits: 3,
        willForce: 'either',
        asked: 0,
        correct: 0,
        streak: 0,
        sessionTotal: 10,
        sessionDone: 0
      };

      // helpers
      function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

      // ensure at least one regroup if requested
      function makeAddends(digits, force){
        while(true){
          const max = Math.pow(10,digits)-1;
          const min = Math.pow(10,digits-1);
          // allow leading-digit smaller values if digits==1
          const a = randInt(digits===1?0:min, max);
          const b = randInt(digits===1?0:min, max);
          const columns = columnSums(a,b,digits);
          const hasRegroup = columns.some(s => s>=10);
          if(force === 'yes' && !hasRegroup) continue;
          if(force === 'no' && hasRegroup) continue;
          return {a,b};
        }
      }

      function columnSums(a,b,digits){
        const arr=[];
        for(let i=0;i<digits;i++){
          const pow=Math.pow(10,i);
          const da = Math.floor(a/pow)%10;
          const db = Math.floor(b/pow)%10;
          arr.push(da+db);
        }
        return arr; // ones first
      }

      // render vertical layout
      function renderProblem(){
        const d = state.digits;
        const a = state.a;
        const b = state.b;
        carryRow.innerHTML = '';
        addendRows.innerHTML = '';
        sumRow.innerHTML = '';

        // carries (empty placeholders)
        const carryDiv = document.createElement('div');
        carryDiv.style.display='flex'; carryDiv.style.gap='6px';
        for(let i=0;i<d;i++){
          const cell = document.createElement('div');
          cell.className='digit-cell'; cell.style.minWidth='34px';
          cell.textContent='';
          carryDiv.appendChild(cell);
        }
        carryRow.appendChild(carryDiv);

        // addends (two rows)
        const rowA = document.createElement('div');
        rowA.style.display='flex'; rowA.style.flexDirection='row-reverse'; rowA.style.gap='6px'; rowA.style.alignItems='center';
        const rowB = document.createElement('div');
        rowB.style.display='flex'; rowB.style.flexDirection='row-reverse'; rowB.style.gap='6px'; rowB.style.alignItems='center';

        for(let i=0;i<d;i++){
          const pow = Math.pow(10,i);
          const da = Math.floor(a/pow)%10;
          const db = Math.floor(b/pow)%10;
          const cellA = document.createElement('div'); cellA.className='digit-cell'; cellA.textContent=da;
          const cellB = document.createElement('div'); cellB.className='digit-cell'; cellB.textContent=db;
          rowA.appendChild(cellA); rowB.appendChild(cellB);
        }
        addendRows.appendChild(rowA);
        addendRows.appendChild(rowB);

        // sum inputs
        const sumDiv = document.createElement('div');
        sumDiv.style.display='flex'; sumDiv.style.flexDirection='row-reverse'; sumDiv.style.gap='6px';
        for(let i=0;i<d;i++){
          const input = document.createElement('input');
          input.type='text'; input.inputMode='numeric';
          input.maxLength=3; input.className='digit-input';
          input.dataset.idx = i;
          input.setAttribute('aria-label','digit '+(i+1));
          input.addEventListener('keydown', handleKeyNav);
          input.addEventListener('input', enforceDigits);
          sumDiv.appendChild(input);
        }
        sumRow.appendChild(sumDiv);

        problemHint.textContent = 'Add the two numbers above. Enter each digit of the sum in the boxes — rightmost box is ones.';
        explainBox.hidden = true;
        blocksArea.hidden = true;

        // focus right-most input
        setTimeout(() => {
          const inputs = sumRow.querySelectorAll('input');
          if(inputs.length) inputs[0].focus();
        }, 50);
      }

      function enforceDigits(e){
        const v = e.target.value.replace(/[^\d\-]/g,''); // allow minus just in case
        e.target.value = v;
      }

      function handleKeyNav(e){
        const idx = Number(e.target.dataset.idx);
        const inputs = Array.from(sumRow.querySelectorAll('input'));
        if(e.key === 'ArrowLeft'){ // move to next (more significant)
          e.preventDefault();
          if(idx+1 < inputs.length) inputs[idx+1].focus();
        } else if(e.key === 'ArrowRight'){
          e.preventDefault();
          if(idx-1 >= 0) inputs[idx-1].focus();
        } else if(e.key === 'Enter'){
          e.preventDefault();
          checkAnswer();
        }
      }

      function getUserDigits(){
        const inputs = Array.from(sumRow.querySelectorAll('input'));
        const d = inputs.map(i => i.value.trim()===''?null:parseInt(i.value,10));
        return d;
      }

      function computeSumArray(){
        const d = state.digits;
        const total = state.a + state.b;
        const arr=[];
        for(let i=0;i<d;i++){
          arr.push(Math.floor(total/Math.pow(10,i))%10);
        }
        return arr;
      }

      function checkAnswer(){
        const user = getUserDigits();
        if(user.some(v=>v===null)){
          // allow incomplete but notify
          flashProblem('Please fill every digit box (use 0 if needed).', false);
          return;
        }
        const correct = computeSumArray();
        let allGood = true;
        const inputs = Array.from(sumRow.querySelectorAll('input'));
        // clear any previous markers
        inputs.forEach(i => { i.style.border='1px dashed rgba(255,255,255,0.05)'; });

        for(let i=0;i<correct.length;i++){
          if(user[i] === correct[i]){
            inputs[i].style.background = 'linear-gradient(90deg, rgba(34,211,238,0.06), rgba(124,58,237,0.02))';
            inputs[i].style.border = '1px solid rgba(34,211,238,0.18)';
          } else {
            inputs[i].style.background = 'linear-gradient(90deg, rgba(239,68,68,0.02), transparent)';
            inputs[i].style.border = '1px solid rgba(239,68,68,0.18)';
            allGood = false;
          }
        }

        state.asked++;
        askedEl.textContent = state.asked;

        if(allGood){
          flashProblem('Correct! Nice work.', true);
          state.correct++;
          state.streak++;
          correctEl.textContent = state.correct;
          streakEl.textContent = state.streak;
          // animate carry display quickly
          showCarriesBrief();
          confetti();
        } else {
          flashProblem('Not quite — press "Explain" for a guided step-by-step.', false);
          state.streak = 0;
          streakEl.textContent = state.streak;
        }

        state.sessionDone++;
        updateProgress();
      }

      function showCarriesBrief(){
        // compute carries like human method: starting from ones, carry floor(sum/10)
        const d = state.digits;
        const carries = new Array(d).fill('');
        let carry = 0;
        for(let i=0;i<d;i++){
          const pow = Math.pow(10,i);
          const da = Math.floor(state.a/pow)%10;
          const db = Math.floor(state.b/pow)%10;
          const s = da + db + carry;
          carry = Math.floor(s/10);
          carries[i] = carry ? carry : '';
        }
        // render carries into top row (right-to-left)
        const cells = Array.from(carryRow.querySelectorAll('.digit-cell'));
        for(let i=0;i<cells.length;i++){
          cells[i].textContent = carries[i] ? carries[i] : '';
        }
        // clear after 1.2s
        setTimeout(()=>{ cells.forEach(c=>c.textContent=''); }, 1200);
      }

      function flashProblem(msg, good){
        const card = document.getElementById('verticalAdd');
        card.classList.remove('correct','wrong');
        if(good) card.classList.add('correct'); else card.classList.add('wrong');
        problemHint.textContent = msg;
        setTimeout(()=>{ card.classList.remove('correct','wrong'); }, 1400);
      }

      function showExplanation(){
        const a = state.a, b = state.b, d = state.digits;
        const colSums = columnSums(a,b,d);
        let text = '';
        let carry=0;
        // explain from right to left but show steps top-down
        for(let i=d-1;i>=0;i--){
          const place = Math.pow(10,i);
          const da = Math.floor(a/place)%10;
          const db = Math.floor(b/place)%10;
          const s = da + db + carry;
          const digit = s % 10;
          const newCarry = Math.floor(s/10);
          text += `Column ${i+1} (place ${i===0?"ones":i===1?"tens":"hundreds"}): ${da} + ${db}` + (carry?` + carry ${carry}`:'') + ` = ${s}. Write ${digit} and carry ${newCarry}.\n`;
          carry = newCarry;
        }
        explainText.textContent = text;
        explainBox.hidden = false;
        blocksArea.hidden = false;

        // create block visualization
        blocksColumns.innerHTML = '';
        // build columns left-to-right (most significant -> ones) visually, but we want rightmost = ones
        for(let i=d-1;i>=0;i--){
          const col = document.createElement('div');
          col.className='column';
          const placeName = i===0 ? 'Ones' : i===1 ? 'Tens' : 'Hundreds';
          const title = document.createElement('div'); title.style.fontSize='12px'; title.style.color='var(--muted)';
          title.textContent = placeName;
          col.appendChild(title);

          // show blocks for a, b
          const pow = Math.pow(10,i);
          const da = Math.floor(a/pow)%10;
          const db = Math.floor(b/pow)%10;
          // ones/tens blocks for addend A
          const groupA = document.createElement('div'); groupA.style.display='flex'; groupA.style.flexDirection='column'; groupA.style.alignItems='center'; groupA.style.gap='4px';
          const labelA = document.createElement('div'); labelA.style.fontSize='12px'; labelA.style.color='var(--muted)'; labelA.textContent='A:';
          groupA.appendChild(labelA);
          for(let k=0;k<da;k++){
            const block = document.createElement('div');
            block.className = i===0 ? 'block' : 'block ten';
            groupA.appendChild(block);
          }
          col.appendChild(groupA);

          // spacer
          const sep = document.createElement('div'); sep.style.height='6px';
          col.appendChild(sep);

          // addend B
          const groupB = document.createElement('div'); groupB.style.display='flex'; groupB.style.flexDirection='column'; groupB.style.alignItems='center'; groupB.style.gap='4px';
          const labelB = document.createElement('div'); labelB.style.fontSize='12px'; labelB.style.color='var(--muted)'; labelB.textContent='B:';
          groupB.appendChild(labelB);
          for(let k=0;k<db;k++){
            const block = document.createElement('div');
            block.className = i===0 ? 'block' : 'block ten';
            groupB.appendChild(block);
          }
          col.appendChild(groupB);

          blocksColumns.appendChild(col);
        }
      }

      // simple confetti using falling squares
      function confetti(){
        const count = 18;
        const container = document.createElement('div');
        container.style.position='fixed'; container.style.left=0; container.style.top=0; container.style.width='100%'; container.style.height='100%';
        container.style.pointerEvents='none'; container.style.overflow='hidden';
        document.body.appendChild(container);
        for(let i=0;i<count;i++){
          const el = document.createElement('div');
          const size = randInt(8,16);
          el.style.width = size+'px'; el.style.height = size+'px';
          el.style.position='absolute';
          el.style.left = randInt(10,90)+'%';
          el.style.top = '-10px';
          el.style.background = i%2? 'linear-gradient(90deg,#22d3ee,#7c3aed)':'linear-gradient(90deg,#ffd27c,#ffb86b)';
          el.style.opacity = Math.random()*0.95+0.2;
          el.style.transform = 'rotate('+randInt(0,360)+'deg)';
          el.style.borderRadius = '2px';
          el.style.zIndex = 9999;
          container.appendChild(el);
          // animate
          const fall = randInt(800,1600);
          el.animate([
            { transform:`translateY(0) rotate(${randInt(0,360)}deg)`, opacity:1 },
            { transform:`translateY(${window.innerHeight + 80}px) rotate(${randInt(360,720)}deg)`, opacity:0.8 }
          ], { duration: fall, easing:'cubic-bezier(.2,.8,.2,1)' });
        }
        setTimeout(()=>{ document.body.removeChild(container); }, 1800);
      }

      function updateProgress(){
        const total = state.sessionTotal;
        const done = state.sessionDone;
        const pct = Math.min(100, Math.round((done/total)*100));
        progBar.style.width = pct + '%';
        sessionInfo.textContent = `Session: ${done} / ${total} done.`;
        // if session complete and in challenge or practice, offer summary
        if(done >= total){
          setTimeout(()=>{ alert(`Session complete! Correct ${state.correct} / ${state.asked}.`); }, 300);
        }
      }

      // generate a new problem
      function newProblem(){
        state.digits = parseInt(digitsSelect.value,10);
        state.willForce = forceRegroup.value;
        state.sessionTotal = Math.max(1, parseInt(problemsInput.value,10) || 10);

        const pair = makeAddends(state.digits, state.willForce);
        state.a = pair.a;
        state.b = pair.b;
        renderProblem();

        // clear stats for new session if starting new session
        state.sessionDone = 0;
        state.asked = 0;
        state.correct = 0;
        state.streak = 0;
        askedEl.textContent = 0;
        correctEl.textContent = 0;
        streakEl.textContent = 0;
        progBar.style.width = '0%';
        sessionInfo.textContent = `Session: 0 / ${state.sessionTotal} done.`;
      }

      // show base-ten blocks toggle
      showBlocksBtn.addEventListener('click',()=>{
        explainBox.hidden = false;
        blocksArea.hidden = !blocksArea.hidden;
        if(!blocksArea.hidden) showExplanation();
      });

      // explain button
      explainBtn.addEventListener('click', () => {
        if(state.a===null) return;
        showExplanation();
      });

      newBtn.addEventListener('click', newProblem);
      checkBtn.addEventListener('click', checkAnswer);

      // keyboard shortcuts
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'n' && (e.ctrlKey || e.metaKey)){
          e.preventDefault(); newProblem();
        }
      });

      // initialize with a problem
      newProblem();

      // small accessibility: announce number values for screen readers when generated
      function announceProblem(){
        const text = `Add ${state.a} and ${state.b}. Rightmost box is ones.`;
        problemHint.textContent = text;
      }
      announceProblem();

      // expose a few functions for debugging in console
      window._additionTool = {
        state,
        newProblem,
        checkAnswer,
        showExplanation
      };

    })();
  </script>
</body>
</html>
